%-----------------------------------------------------------
% Helpers

% From [this answer by @DavidCarlisle](https://tex.stackexchange.com/a/708876/64441).
\newcommand\notwhite{black}
\newcommand\notblack{white}

% From [this answer by @Skillmon](https://tex.stackexchange.com/a/708866/64441).
\ExplSyntaxOn
  \cs_new_eq:NN \ifStrEq \str_if_eq:nnTF
\ExplSyntaxOff

% Parameters
%
% 1: stone color (black or white)
% 2: X Coordinate
% 3: Y Coordinate
% 
% Example: `\drawStone{black}{2}{3}`
\newcommand{\drawStoneRaw}[3]{
  \pgfmathsetmacro{\xCoord}{\step * (#2 - 1)}
  \pgfmathsetmacro{\yCoord}{\step * (#3 - 1)}
  \pgfmathsetmacro{\outlineWidth}{\step / 20}
  \pgfmathsetmacro{\stoneRadius}{\step * \ifStrEq{black}{#1}{0.99}{0.95} / 2}

  \draw[
    draw = \UseName{not#1},
    fill = #1, 
    line width = \outlineWidth
  ]
    (\xCoord, \yCoord)
    circle [radius = \stoneRadius]
}

\newcounter{moveCounter}
\setcounter{moveCounter}{1}

\newcommand{\stepMoveCounter}{
  \stepcounter{moveCounter}
}

% From [this answer by @DavidCarlisle](https://tex.stackexchange.com/a/708893/64441).
\ExplSyntaxOn
  \cs_generate_variant:Nn \int_from_alph:n {e}

  \newcommand\stringToCoordX[1]{
    \int_from_alph:e{\use_i:nn#1}
  }
  \newcommand\stringToCoordY[1]{
    ~\int_from_alph:e{\use_ii:nn#1}
  }
\ExplSyntaxOff

%-----------------------------------------------------------
% Drawing Moves and Stones

\newcommand{\drawStone}[3]{
  \drawStoneRaw{#1}{#2}{#3};
}

% Parameters
%
% 1: stone color (black or white)
% 2: X Coordinate
% 3: Y Coordinate
% 
% Example: `\drawMove{black}{2}{3}`
\newcommand{\drawMove}[3]{
  \drawStoneRaw{#1}{#2}{#3}
    % TODO: Change fontsize if the number goes beyond 99.
    node[color = \UseName{not#1}]
      {\themoveCounter};

  \stepMoveCounter
}

%-----------------------------------------------------------
% Draw from SGF Coords

% It works with both lower and uppercase coordinates.
%
% Parameters
%
% 1: stone color (black or white)
% 2: SGF Coordinates
% 
% Example: `\drawStoneFromSgfCoords{black}{ab}`
\newcommand{\drawStoneFromSgfCoords}[2]{
  \drawStone{#1}{\stringToCoordX{#2}}{\stringToCoordY{#2}}
}

% It works with both lower and uppercase coordinates.
%
% Parameters
%
% 1: move color (black or white)
% 2: SGF Coordinates
% 
% Example: `\drawMoveFromSgfCoords{black}{ab}`
\newcommand{\drawMoveFromSgfCoords}[2]{
  \drawMove{#1}{\stringToCoordX{#2}}{\stringToCoordY{#2}}
}

% From [this answer by @JasperHabicht](https://tex.stackexchange.com/a/708961/64441).
%
% Parameters
%
% 1: array of {<black | white>, <coordinates}
%
% Example usage: `drawStonesFromSgfCoords{{black, ab}, {white, cd}}`
\ExplSyntaxOn
  \NewExpandableDocumentCommand{\drawStonesFromSgfCoords}{ m }{
    \clist_set:Nn \l_tmpa_clist { #1 }
    \clist_map_inline:Nn \l_tmpa_clist {
      \clist_set:Nn \l_tmpb_clist { ##1 }
      \clist_pop:NN \l_tmpb_clist \l_tmpa_tl 
      \clist_pop:NN \l_tmpb_clist \l_tmpb_tl 
      \exp_args:Noo \drawStoneFromSgfCoords { \l_tmpa_tl } { \l_tmpb_tl }
    }
  }
\ExplSyntaxOff

% From [this answer by @JasperHabicht](https://tex.stackexchange.com/a/708961/64441).
%
% Parameters
%
% 1: array of {<black | white>, <coordinates}
%
% Example usage: `drawMovesFromSgfCoords{{black, ab}, {white, cd}}`
\ExplSyntaxOn
  \NewExpandableDocumentCommand{\drawMovesFromSgfCoords}{ m }{
    \clist_set:Nn \l_tmpa_clist { #1 }
    \clist_map_inline:Nn \l_tmpa_clist {
      \clist_set:Nn \l_tmpb_clist { ##1 }
      \clist_pop:NN \l_tmpb_clist \l_tmpa_tl 
      \clist_pop:NN \l_tmpb_clist \l_tmpb_tl 
      \exp_args:Noo \drawMoveFromSgfCoords { \l_tmpa_tl } { \l_tmpb_tl }
    }
  }
\ExplSyntaxOff

%-----------------------------------------------------------
% Parse SGF



%-----------------------------------------------------------